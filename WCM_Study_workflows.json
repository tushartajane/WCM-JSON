[
   {
  "name" : "dictionary",
  "view" : null,
  "ctrl" : null,
  "data" : {
    "fields" : [ {
      "name" : "cpr.registrationDate",
      "caption" : "Registration Date",
      "type" : "date",
      "optional" : false,
      "defaultValue" : "current_date",
      "showInOverviewIf" : "useShowIf",
      "showIf" : {
        "op" : "OR",
        "rules" : [ {
          "field" : "cp.nonExistingField",
          "op" : "exists"
        } ]
      }
    }, {
      "name" : "cpr.ppid",
      "caption" : "Registry ID",
      "type" : "text",
      "optional" : false,
      "showIf" : {
        "op" : "OR",
        "rules" : [ {
          "field" : "cp.ppidFmt",
          "op" : "not_exist"
        }, {
          "field" : "cp.manualPpidEnabled",
          "op" : "exists"
        } ]
      }
    }, {
      "name" : "cpr.site",
      "caption" : "Registration Site",
      "type" : "dropdown",
      "optional" : true,
      "listSource" : {
        "apiUrl" : "collection-protocols/{{cp.id}}/sites",
        "displayProp" : "name",
        "selectProp" : "name",
        "queryParams" : { }
      }
    }, {
      "name" : "cpr.participant.lastName",
      "caption" : "Last Name",
      "type" : "text",
      "optional" : true
    }, {
      "name" : "cpr.participant.firstName",
      "caption" : "First Name",
      "type" : "text",
      "optional" : true
    }, {
      "name" : "cpr.participant.middleName",
      "caption" : "Middle Name",
      "type" : "text",
      "optional" : true
    }, {
      "name" : "cpr.participant.birthDate",
      "caption" : "DOB",
      "type" : "date",
      "formatType" : "date",
      "dateOnly" : true,
      "optional" : true
    }, {
      "name" : "cpr.participant.empi",
      "caption" : "MRN",
      "type" : "text",
      "optional" : true
    }, {
      "name" : "cpr.participant.gender",
      "caption" : "Gender",
      "type" : "pvs",
      "attr" : "gender",
      "optional" : true
    }, {
      "name" : "cpr.participant.ethnicities",
      "caption" : "Ethnicity",
      "type" : "pvs",
      "attr" : "ethnicity",
      "optional" : true,
      "multiple" : true
    }, {
      "name" : "cpr.participant.races",
      "caption" : "Race",
      "type" : "pvs",
      "attr" : "race",
      "optional" : true,
      "multiple" : true
    }, {
      "name" : "visit.name",
      "caption" : "Event IBC Code",
      "type" : "text",
      "optional" : true,
      "showIf" : {
        "op" : "OR",
        "rules" : [ {
          "field" : "cp.visitNameFmt",
          "op" : "not_exist"
        }, {
          "field" : "cp.manualVisitNameEnabled",
          "op" : "exists"
        } ]
      }
    },
    {
      "name" : "visit.extensionDetail.attrsMap.DD2",
      "caption" : "Collection Facility",
      "type" : "dropdown",
      "optional" : true,
      "listSource" : {
        "apiUrl" : "forms/permissible-values",
        "selectProp" : "value",
        "displayProp" : "value",
        "queryParams" : {
          "dynamic" : { },
          "static" : {
            "formName" : "wCMVisit",
            "controlName" : "DD2"
          }
        }
      }
    },
     {
      "name" : "visit.extensionDetail.attrsMap.DD5",
      "caption" : "Collection Procedure",
      "type" : "dropdown",
      "optional" : true,
      "listSource" : {
        "apiUrl" : "forms/permissible-values",
        "selectProp" : "value",
        "displayProp" : "value",
        "queryParams" : {
          "dynamic" : { },
          "static" : {
            "formName" : "wCMVisit",
            "controlName" : "DD5"
          }
        }
      }
    }, {
      "name" : "visit.extensionDetail.attrsMap.DD6",
      "caption" : "Surgeon / Clinician",
      "type" : "dropdown",
      "optional" : true,
      "listSource" : {
        "apiUrl" : "forms/permissible-values",
        "selectProp" : "value",
        "displayProp" : "value",
        "queryParams" : {
          "dynamic" : { },
          "static" : {
            "formName" : "wCMVisit",
            "controlName" : "DD6"
          }
        }
      }
    }, {
      "name" : "visit.visitDate",
      "caption" : "Procedure Date",
      "type" : "date",
      "defaultValue" : "current_date",
      "optional" : false
    }, {
      "name" : "specimen.label",
      "caption" : "IBC Code",
      "type" : "text",
      "optional" : true,
      "showIf" : {
        "op" : "OR",
        "rules" : [ {
          "field" : "specimen.labelFmt",
          "op" : "not_exist"
        }, {
          "field" : "cp.manualSpecLabelEnabled",
          "op" : "exists"
        } ]
      }
    }, {
      "name" : "specimen.type",
      "caption" : "Specimen Type",
      "type" : "specimen-type",
      "specimen" : "specimen",
      "optional" : false,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "!=",
          "value" : "'Aliquot'"
        } ]
      }
    },
    {
      "name" : "specimen.initialQty",
      "caption" : "Initial Volume",
      "showInOverviewIf" : "useShowIf",
      "type" : "specimen-quantity",
      "specimen" : "specimen",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.specimenClass",
          "op" : "==",
          "value" : "'Fluid'"
        } ]
      }
    },
    {
      "name" : "specimen.extensionDetail.attrsMap.DD11",
      "caption" : "Vessel Type",
      "type" : "dropdown",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.specimenClass",
          "op" : "==",
          "value" : "'Fluid'"
        } ]
      },
      "listSource" : {
        "apiUrl" : "forms/permissible-values",
        "selectProp" : "value",
        "displayProp" : "value",
        "queryParams" : {
          "dynamic" : { },
          "static" : {
            "formName" : "wCMCSpecimenFields",
            "controlName" : "DD11"
          }
        }
      }
    },
    {
      "name" : "specimen.extensionDetail.attrsMap.DP14",
      "caption" : "Date/Time Drawn",
      "type" : "datetime",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "==",
          "value" : "'Fluid'"
        } ]
      }
    },
    {
      "name" : "specimen.extensionDetail.attrsMap.ST7",
      "caption" : "Accession #",
      "type" : "text",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.ST8",
      "caption" : "Part",
      "type" : "text",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      }
    }, {
      "name" : "specimen.anatomicSite",
      "caption" : "Anatomic Site",
      "type" : "pvs",
      "attr" : "anatomic_site",
      "optional" : true,
      "showInOverviewIf" : "useShowIf",
      "showOnlyLeafValues" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      }
    }, {
      "name" : "specimen.laterality",
      "caption" : "Laterality",
      "type" : "pvs",
      "attr" : "laterality",
      "optional" : true,
      "showInOverviewIf" : "useShowIf",
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.RB2",
      "caption" : "Disease Status",
      "showInOverviewIf" : "useShowIf",
      "type" : "radio",
      "optional" : false,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      },
      "options" : [ {
        "value" : "Primary",
        "caption" : "Primary"
      }, {
        "value" : "Metastatic",
        "caption" : "Metastatic"
      } ]
    }, {
      "name" : "specimen.extensionDetail.attrsMap.MLB3",
      "caption" : "Site of Origin",
      "type" : "dropdown",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.extensionDetail.attrsMap.RB2",
          "op" : "==",
          "value" : "'Metastatic'"
        }, {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      },
      "listSource" : {
        "apiUrl" : "forms/permissible-values",
        "selectProp" : "value",
        "displayProp" : "value",
        "queryParams" : {
          "dynamic" : { },
          "static" : {
            "formName" : "wCMCSpecimenFields",
            "controlName" : "MLB3"
          }
        }
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.DD26",
      "caption" : "Pathological Dx",
      "type" : "dropdown",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      },
      "listSource" : {
        "apiUrl" : "forms/permissible-values",
        "selectProp" : "value",
        "displayProp" : "value",
        "queryParams" : {
          "dynamic" : { },
          "static" : {
            "formName" : "wCMCSpecimenFields",
            "controlName" : "DD26"
          }
        }
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.DD4",
      "caption" : "Histological Subtype",
      "type" : "dropdown",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      },
      "listSource" : {
        "apiUrl" : "forms/permissible-values",
        "selectProp" : "value",
        "displayProp" : "value",
        "queryParams" : {
          "dynamic" : { },
          "static" : {
            "formName" : "wCMCSpecimenFields",
            "controlName" : "DD4"
          }
        }
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.DD5",
      "caption" : "Histological Grade",
      "type" : "dropdown",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      },
      "listSource" : {
        "apiUrl" : "forms/permissible-values",
        "selectProp" : "value",
        "displayProp" : "value",
        "queryParams" : {
          "dynamic" : { },
          "static" : {
            "formName" : "wCMCSpecimenFields",
            "controlName" : "DD5"
          }
        }
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.DP10",
      "caption" : "Date/Time Excised",
      "type" : "datetime",
      "showInOverviewIf" : "useShowIf",
      "defaultValue": "field:visit.visitDate",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        }, {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        } ]
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.DP9",
      "caption" : "Date/Time Preserved",
      "type" : "datetime",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        }, {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        } ]
      }
    }, {
      "name" : "calcSpecimen.ischemiaTimePrimary",
      "displayExpr" : "fns.ifNotNull(specimen.extensionDetail.attrsMap.DP9,fns.dateDiffInMinutes(specimen.extensionDetail.attrsMap.DP10, specimen.extensionDetail.attrsMap.DP9, true) + ' mins', 'Not Applicable')",
      "caption" : "Ischemia Time",
      "showInOverviewIf" : "useShowIf",
      "type" : "span",
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        } ]
      }
    },
     {
      "name" : "specimen.extensionDetail.attrsMap.DD6",
      "caption" : "Receptor Status",
      "type" : "pvs",
      "showInOverviewIf" : "useShowIf",
      "multiple" : true,
      "optional" : true,
      "attr" : "receptor_status",
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      }
    }, {
      "name" : "specimen.biohazards",
      "caption" : "Infectious Disease",
      "type" : "pvs",
      "showInOverviewIf" : "useShowIf",
      "multiple" : true,
      "attr" : "specimen-biohazard",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.DD24",
      "caption" : "Grade",
      "type" : "dropdown",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "!=",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "==",
          "value" : "'Fluid'"
        } ]
      },
      "listSource" : {
        "apiUrl" : "forms/permissible-values",
        "selectProp" : "value",
        "displayProp" : "value",
        "queryParams" : {
          "dynamic" : { },
          "static" : {
            "formName" : "wCMCSpecimenFields",
            "controlName" : "DD24"
          }
        }
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.DP25",
      "caption" : "Date/Time Frozen",
      "type" : "datetime",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "!=",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "==",
          "value" : "'Fluid'"
        } ]
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.DP12",
      "caption" : "Date/Time Processed",
      "type" : "datetime",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "==",
          "value" : "'Fluid'"
        } ]
      }
    },   {
      "name" : "specimen.lineage",
      "caption" : "Lineage",
      "type" : "radio",
      "optional" : false,
      "showInOverviewIf" : "specimen.lineage!='New'",
      "options" : [ {
        "value" : "New",
        "caption" : "New"
      }, {
        "value" : "Derived",
        "caption" : "Derived"
      }, {
        "value" : "Aliquot",
        "caption" : "Aliquot"
      } ]
    },  {
      "name" : "specimen.concentration",
      "caption" : "Concentration",
      "showInOverviewIf" : "useShowIf",
      "type" : "specimen-quantity",
      "specimen" : "specimen",
      "measure" : "concentration",
      "pattern" : "/^([0-9]+|[0-9]*\\.?[0-9]+[e]?[+-]?[0-9]*)$/",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "!=",
          "value" : "'New'"
        } ]
      }
    }, {
      "name" : "specimen.parentLabel",
      "caption" : "Parent Specimen",
      "type" : "text",
      "optional" : false,
      "showInOverviewIf" : "useShowIf",
      "url" : "specimen({specimenId: specimen.parentId})",
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "!=",
          "value" : "'New'"
        } ]
      },
      "modelOpts" : {
        "updateOn" : "blur"
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.ST15",
      "caption" : "Yield (µg)",
      "type" : "text",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'Derived'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.NT19",
      "caption" : "Volume",
      "showInOverviewIf" : "useShowIf",
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'Derived'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      },
      "type" : "text",
      "optional" : true,
      "pattern" : "/^([0-9]+|[0-9]*\\.?[0-9]+[e]?[+-]?[0-9]*)$/"
    }, {
      "name" : "specimen.extensionDetail.attrsMap.ST16",
      "caption" : "A260/A230",
      "type" : "text",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'Derived'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.ST17",
      "caption" : "A260/A280",
      "type" : "text",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'Derived'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "!=",
          "value" : "'Fluid'"
        } ]
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.DD20",
      "caption" : "Tissue Status",
      "type" : "dropdown",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'Aliquot'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "==",
          "value" : "'Tissue'"
        } ]
      },
      "listSource" : {
        "apiUrl" : "forms/permissible-values",
        "selectProp" : "value",
        "displayProp" : "value",
        "queryParams" : {
          "dynamic" : { },
          "static" : {
            "formName" : "wCMCSpecimenFields",
            "controlName" : "DD20"
          }
        }
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.NT21",
      "caption" : "Length (cm)",
      "type" : "text",
      "pattern": "^([0-9]*|[0-9]+\\.?[0-9]+)$",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'Aliquot'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "==",
          "value" : "'Tissue'"
        } ]
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.NT22",
      "caption" : "Width (cm)",
      "type" : "text",
      "pattern": "^([0-9]*|[0-9]+\\.?[0-9]+)$",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'Aliquot'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "==",
          "value" : "'Tissue'"
        } ]
      }
    }, {
      "name" : "specimen.extensionDetail.attrsMap.NT23",
      "caption" : "Height (cm)",
      "type" : "text",
      "pattern": "^([0-9]*|[0-9]+\\.?[0-9]+)$",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "==",
          "value" : "'Aliquot'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "==",
          "value" : "'Tissue'"
        } ]
      }
    }, {
      "name" : "specimen.storageLocation",
      "caption" : "Location",
      "type" : "storage-position",
      "showInOverviewIf" : "useShowIf",
      "optional" : true,
      "cpId" : "specimen.cpId",
      "entity" : "specimen",
      "url" : "container-detail.locations({containerId: specimen.storageLocation.id})",
      "showIf" : {
        "op" : "OR",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "!=",
          "value" : "'New'"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "==",
          "value" : "'Fluid'"
        } ]
      },
      "subFields" : [ {
        "name" : "name",
        "caption" : "Container Name"
      }, {
        "name" : "positionY",
        "caption" : "Container Row"
      }, {
        "name" : "positionX",
        "caption" : "Container Column"
      } ]
    } ],
    "layout" : [ {
      "rows" : [ [ "cpr.ppid" ], [ "cpr.site" ], [ "cpr.participant.lastName", "cpr.participant.firstName", "cpr.participant.middleName" ], [ "cpr.participant.birthDate" ], [ "cpr.participant.empi" ], [ "cpr.participant.gender" ], [ "cpr.participant.ethnicities" ], [ "cpr.participant.races" ], [ "visit.name", "visit.extensionDetail.attrsMap.DD2" ,"visit.visitDate" ], [ "visit.extensionDetail.attrsMap.DD6", "visit.extensionDetail.attrsMap.DD5" ], [ "specimen.label", "specimen.type", "specimen.extensionDetail.attrsMap.ST7", "specimen.extensionDetail.attrsMap.DD11" ], [ "specimen.extensionDetail.attrsMap.RB2", "specimen.extensionDetail.attrsMap.ST8" ], [ "specimen.anatomicSite", "specimen.extensionDetail.attrsMap.DP10" ], [ "specimen.laterality", "specimen.extensionDetail.attrsMap.DP9" ], [ "specimen.extensionDetail.attrsMap.MLB3" ], [ "specimen.extensionDetail.attrsMap.DD26", "calcSpecimen.ischemiaTimePrimary" ], [ "specimen.extensionDetail.attrsMap.DD4", "specimen.biohazards" ], [ "specimen.extensionDetail.attrsMap.DD5" ], [ "specimen.extensionDetail.attrsMap.DD6" ], [ "specimen.extensionDetail.attrsMap.DP14", "specimen.extensionDetail.attrsMap.DP12" ], [ "specimen.comments" ], [ "specimen.initialQty", "specimen.storageLocation" ], [ "specimen.extensionDetail.attrsMap.ST15", "specimen.extensionDetail.attrsMap.ST16", "specimen.extensionDetail.attrsMap.ST17", "specimen.concentration", "specimen.extensionDetail.attrsMap.NT19" ], [ "specimen.extensionDetail.attrsMap.DD20", "specimen.extensionDetail.attrsMap.NT21", "specimen.extensionDetail.attrsMap.NT22", "specimen.extensionDetail.attrsMap.NT23" ] ]
    } ]
  }
}, {
  "name" : "common",
  "view" : null,
  "ctrl" : null,
  "data" : {
    "spmnDescTmpl" : "<span ng-if=\"specimen.lineage == 'New' || detailed\"><span ng-if=\"specimen.specimenClass != 'Fluid'\"><span ng-if=\"!!specimen.label\">{{specimen.label}}:</span><span ng-if=\"!!specimen.extensionDetail.attrsMap.ST7\">{{specimen.extensionDetail.attrsMap.ST7}}</span><span ng-if=\"!!specimen.anatomicSite\">: {{specimen.extensionDetail.attrsMap.ST8}} ({{specimen.anatomicSite}})</span></span></span><span ng-if=\"specimen.lineage == 'New' || detailed\"><span ng-if=\"specimen.specimenClass == 'Fluid'\"><span ng-if=\"!!specimen.label\">{{specimen.label}}: </span><span ng-if=\"!!specimen.type\">{{specimen.type}}: </span><span ng-if=\"!!specimen.extensionDetail.attrsMap.DD11\"> {{specimen.extensionDetail.attrsMap.DD11}}</span><span ng-if=\"!!specimen.initialQty\"> ({{specimen.initialQty}})</span></span></span></span><span ng-if=\"specimen.lineage == 'Aliquot' && !detailed\"> <span>{{specimen.label}}</span> </span> <span ng-if=\"specimen.lineage == 'Derived' && !detailed\"> <span>{{specimen.label}}</span> </span> <span ng-if=\"!!showReqLabel\"> <span ng-switch on=\"(!!specimen.name || !!specimen.reqLabel) && specimen.lineage != 'Aliquot'\"> <span ng-switch-when=\"true\"> ({{specimen.name || specimen.reqLabel}})</span> <span ng-switch-default> <span ng-if=\"!!specimen.code || !!specimen.reqCode\"> ({{specimen.code || specimen.reqCode}})</span> </span> </span> </span>",
    "participantHeader" : {
      "leftTitle" : "<div ng-style=\"!!cpr.ppid && {'font-size': '18px', 'margin-top': '-10px'}\" ng-if=\"userCtx.hasPhiAccess\"><div><br><b>{{cpr.participant.lastName}}, {{cpr.participant.firstName}} ({{cpr.ppid}})</b></br></div></div>"
    },
    "visitHeader" : {
      "rightTitle" : "<div ng-style=\"!!cpr.ppid && {'font-size': '20px', 'margin-top': '-15px'}\" ng-if=\"userCtx.hasPhiAccess\"><div><br><b>{{cpr.participant.lastName}}, {{cpr.participant.firstName}} ({{cpr.ppid}})</b></br></div></div>"
    },
    "specimenHeader" : {
      "breadcrumb" : "<ul os-breadcrumbs><li><a ui-sref=\"cp-list-view({cpId: cpr.cpId})\">{{cp.shortTitle}}</a></li><li><a ui-sref=\"participant-detail.overview({cprId: cpr.id})\">{{cpr.ppid}}</a></li><li><a ui-sref=\"visit-detail.overview({visitId: visit.id, eventId: visit.eventId})\">{{visit.name}}</a></li></ul>",
      "leftTitle" : "<div> <span ng-style=\"{'font-size': '16px' ,'font-weight': 'bold', 'margin-top': '15px'}\"> <span ng-if=\"!specimen.label && !specimen.type\">Create Parent(s)</span><span>{{specimen.label}}</span></br></div>",
      "rightTitle" : "<div ng-style=\"!!cpr.ppid && {'font-size': '18px', 'margin-top': '-15px'}\" ng-if=\"userCtx.hasPhiAccess\"><div><br><b>{{cpr.participant.lastName}}, {{cpr.participant.firstName}} ({{cpr.ppid}})</b></br></div></div>"
    },
    "addSpecimen" : {
      "allowMultipleSpecimens" : false,
      "showCreateAliquots" : false,
      "cardTitleTmpl":"<span ng-if=\"specimen.specimenClass=='Fluid'\"><span>{{$index + 1}}) <os-specimen-desc cp=\"cp\" specimen=\"specimen\"></os-specimen-desc></span></span><span ng-if=\"specimen.specimenClass == 'Tissue'\"><span><os-specimen-desc cp=\"cp\" specimen=\"specimen\"></os-specimen-desc></span></span>"
    },
    "derivedSpecimens" : [ {
      "title" : "",
      "hideCopyFirstToAll": true,
      "criteria" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.parent.id",
          "op" : "exists"
        }, {
          "field" : "specimen.parent.specimenClass",
          "op" : "==",
          "value" : "'Tissue'"
        } ]
      },
      "enableCofrc" : false,
      "fields" : [ {
        "name" : "specimen.parent.label",
        "caption" : "Parent Specimen",
        "url": "specimen({specimenId: specimen.parent.id})",
        "type" : "span"
      }, {
        "name" : "specimen.parent.type",
        "caption" : "Specimen Type",
        "type" : "span"
      }, {
        "name" : "specimen.type",
        "caption" : "Derivative Type",
        "type" : "specimen-type",
        "specimen" : "specimen",
        "optional" : false,
        "width" : "170px"
      }, {
        "name" : "specimen.concentration",
        "caption" : "Concentration",
        "type" : "specimen-quantity",
        "specimen" : "specimen",
        "measure" : "concentration",
        "optional" : true,
        "width" : "120px"
      }, {
        "name" : "specimen.extensionDetail.attrsMap.ST15",
        "baseField" : "specimen.extensionDetail.attrsMap.ST15",
        "width" : "80px"
      }, {
        "name" : "specimen.initialQty",
        "caption" : "Volume",
        "type" : "specimen-quantity",
        "specimen" : "specimen",
        "optional" : true,
        "width" : "80px"
      }, {
        "name" : "specimen.extensionDetail.attrsMap.ST16",
        "baseField" : "specimen.extensionDetail.attrsMap.ST16",
        "width" : "90px"
      }, {
        "name" : "specimen.extensionDetail.attrsMap.ST17",
        "baseField" : "specimen.extensionDetail.attrsMap.ST17",
        "width" : "90px"
      }, {
        "name" : "specimen.storageLocation",
        "caption" : "Location",
        "type" : "storage-position",
        "optional" : true,
        "cpId" : "specimen.cpId",
        "entity" : "specimen",
        "width" : "240px",
        "copyValueFn" : "function(firstRowVal, currentVal) { if ((!!currentVal && !!currentVal.reservationId) && (!!firstRowVal && !!firstRowVal.reservationId)) { return currentVal;} else if (firstRowVal) { return { id: '', name: firstRowVal.name, mode: firstRowVal.mode, positionX: '', positionY: '', position: '', reservationId: '' };} else { return {}; }}"
      }, {
        "name" : "specimen.printLabel",
        "caption" : "Print",
        "icon" : "fa fa-print",
        "type" : "toggle-checkbox",
        "width" : "30px"
      }, {
        "name" : "specimen.closeParent",
        "caption" : "Close Parent",
        "icon" : "fa fa-ban",
        "type" : "toggle-checkbox",
        "width" : "30px",
        "defaultValue" : true
      } ]
    }, {
      "title" : "",
      "hideCopyFirstToAll": true,
      "criteria" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.parent.id",
          "op" : "exists"
        }, {
          "field" : "specimen.parent.specimenClass",
          "op" : "==",
          "value" : "'Fluid'"
        } ]
      },
      "enableCofrc" : false,
      "fields" : [ {
        "name" : "specimen.parent.label",
        "caption" : "Parent Specimen",
        "type" : "span",
        "url": "specimen({specimenId: specimen.parent.id})"
      }, {
        "name" : "specimen.parent.type",
        "caption" : "Specimen Type",
        "type" : "span"
      },
      {
        "name" : "specimen.extensionDetail.attrsMap.DD11",
        "baseField" : "specimen.extensionDetail.attrsMap.DD11",
        "defaultValue": "field: specimen.parent.extensionDetail.attrsMap.DD11",
        "width" : "120px"
      },
       {
        "name" : "specimen.type",
        "caption" : "Derivative Type",
        "type" : "specimen-type",
        "specimen" : "specimen",
        "optional" : false,
        "width" : "170px"
      }, {
        "name" : "specimen.initialQty",
        "caption" : "Volume",
        "type" : "specimen-quantity",
        "specimen" : "specimen",
        "optional" : true,
        "width" : "80px"
      }, {
        "name" : "specimen.concentration",
        "caption" : "Concentration",
        "type" : "specimen-quantity",
        "specimen" : "specimen",
        "measure" : "concentration",
        "optional" : true,
        "width" : "120px"
      }, {
        "name" : "specimen.extensionDetail.attrsMap.DD24",
        "baseField" : "specimen.extensionDetail.attrsMap.DD24",
        "width" : "100px"
      }, {
        "name" : "specimen.extensionDetail.attrsMap.DP25",
        "baseField" : "specimen.extensionDetail.attrsMap.DP25",
        "width" : "220px",
        "type" : "datetime",
        "optional" : true
      }, {
        "name" : "specimen.printLabel",
        "caption" : "Print",
        "icon" : "fa fa-print",
        "width" : "30px",
        "type" : "toggle-checkbox"
      }, {
        "name" : "specimen.closeParent",
        "caption" : "Close Parent",
        "icon" : "fa fa-ban",
        "type" : "toggle-checkbox",
        "width" : "30px",
        "defaultValue" : true
      } ]
    } ],
    "aliquotsCollection" : [ {
      "title" : "",
      "hideCopyFirstToAll": true,
      "criteria" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.parent.id",
          "op" : "exists"
        }, {
          "field" : "specimen.specimenClass",
          "op" : "==",
          "value" : "'Tissue'"
        } ]
      },
      "enableCofrc" : false,
      "fields" : [ {
        "name" : "specimen.parent.label",
        "caption" : "Parent Specimen",
        "type" : "span",
        "url": "specimen({specimenId: specimen.parent.id})"
      }, {
        "name" : "specimen.type",
        "baseField" : "specimen.type"
      }, {
        "name" : "specimen.extensionDetail.attrsMap.DD20",
        "baseField" : "specimen.extensionDetail.attrsMap.DD20"
      }, {
        "name" : "specimen.noOfAliquots",
        "caption" : "# Duplicate(s)",
        "type" : "text"
      }, {
        "name" : "specimen.qtyPerAliquot",
        "baseField" : "specimen.initialQty",
        "caption" : "Weight",
        "width" : "110px"
      }, {
        "name" : "specimen.extensionDetail.attrsMap.NT21",
        "baseField" : "specimen.extensionDetail.attrsMap.NT21",
        "width" : "110px"
      }, {
        "name" : "specimen.extensionDetail.attrsMap.NT22",
        "baseField" : "specimen.extensionDetail.attrsMap.NT22",
        "width" : "110px"
      }, {
        "name" : "specimen.extensionDetail.attrsMap.NT23",
        "baseField" : "specimen.extensionDetail.attrsMap.NT23",
        "width" : "110px"
      }, {
        "name" : "specimen.storageLocation",
        "baseField" : "specimen.storageLocation",
        "caption" : "Location",
        "width" : "180px"
      }, {
        "name" : "specimen.printLabel",
        "caption" : "Print",
        "icon" : "fa fa-print",
        "type" : "toggle-checkbox",
        "width" : "30px"
      }, {
        "name" : "specimen.closeParent",
        "caption" : "Close Parent",
        "icon" : "fa fa-ban",
        "type" : "toggle-checkbox",
        "width" : "30px"
      } ]
    },
    {
      "title" : "Error: Please use the “Create Derivative(s)” page in order to create aliquot(s)/derivative(s) for biofluids.",
      "hideCopyFirstToAll": true,
      "criteria" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.parent.id",
          "op" : "exists"
        }, {
          "field" : "specimen.parent.specimenClass",
          "op" : "==",
          "value" : "'Fluid'"
        } ]
      },
      "enableCofrc" : false,
      "fields" : [ {
        "name" : "specimen.parent.label",
        "caption" : "Parent Specimen",
        "type" : "span",
        "url": "specimen({specimenId: specimen.parent.id})"
      }, {
        "name" : "specimen.parent.type",
        "caption" : "Specimen Type",
        "type" : "span"
      }
        ]
    } ]
  }
}, {
  "name" : "specimenTree",
  "view" : null,
  "ctrl" : null,
  "data" : {
    "summaryDescTmpl" : "<span ng-if=\"specimen.lineage == 'New' || detailed\"> <span ng-if=\"specimen.specimenClass == 'Fluid'\"> <span ng-if=\"!!specimen.extensionDetail.attrsMap.DP14\">{{specimen.visitDate | date: 'MM-dd-yy'}}: </span> <span ng-if=\"!!specimen.label\">{{specimen.label}}</span> <span ng-if=\"!!specimen.extensionDetail.attrsMap.DD11 && specimen.extensionDetail.attrsMap.DD11 != 'Not Specified'\"> <span ng-if=\"!!specimen.label\"></span> <span>({{specimen.extensionDetail.attrsMap.DD11}})</span> </span> </span> <span ng-if=\"specimen.specimenClass != 'Fluid'\"> <span ng-if=\"!!specimen.extensionDetail.attrsMap.DP9\">{{specimen.visitDate | date: 'MM-dd-yy'}}: </span> <span ng-if=\"!!specimen.label\">{{specimen.label}}</span> <span ng-if=\"!!specimen.anatomicSite && specimen.anatomicSite != 'Not Specified'\">({{specimen.anatomicSite}})</span> </span></span><span ng-if=\"specimen.lineage != 'New' || detailed\"> <span>{{specimen.label}}</span></span><span ng-if=\"!!showReqLabel\"> <span ng-switch on=\"(!!specimen.name || !!specimen.reqLabel) && specimen.lineage != 'Aliquot'\"> <span ng-switch-when=\"true\"> ({{specimen.name || specimen.reqLabel}})</span> <span ng-switch-default> <span ng-if=\"!!specimen.code || !!specimen.reqCode\"> ({{specimen.code || specimen.reqCode}})</span> </span> </span></span>",
    "fields" : [ {
      "name" : "specimen",
      "caption" : "IBC Code",
      "type" : "specimen-description",
      "width" : "360px"
    },

    {
      "name" : "specimen.type",
      "caption" : "Type",
      "type" : "text",
      "width" : "150px"
    },
    {
      "name" : "specimen.extensionDetail.attrsMap.DD20",
      "baseField" : "specimen.extensionDetail.attrsMap.DD20",
      "caption" : "Tissue Status",
      "width" : "200px"
    },
    {
      "name" : "specimen.extensionDetail.attrsMap.DD11",
      "baseField" : "specimen.extensionDetail.attrsMap.DD11",
      "caption" : "Vessel Type",
      "width" : "200px"
    },
    {
      "name" : "specimen.storageLocation",
      "caption" : "Location",
      "baseField" : "specimen.storageLocation",
      "width" : "200px",
      "showIf" : {
        "op" : "AND",
        "rules" : [ {
          "field" : "specimen.lineage",
          "op" : "!=",
          "value" : "'New'"
        } ]
      }
    } ],
    "hideDerivatives": true
  }
},
{
  "name": "visitsTab",
  "view": null,
  "ctrl": null,
  "data": {
    "occurred": [
      {
      "field": "visit.eventLabel",
      "name": "visit.eventLabel",
      "caption": "Event Label",
      "type": "text",
      "optional": false,
      "width": "150px"
      },
      {
        "field": "visit.name",
        "baseField": "visit.name",
        "width": "150px"
      },
      {
        "field": "visit.visitDate",
        "baseField": "visit.visitDate",
        "caption":"Procedure Date",
        "width": "150px"
      }
    ]
  }
},
{
      "name": "labelSettings",
      "data": {
        "specimen": {
          "rules": [
            {
              "criteria": "#specimen.lineage == 'Derived' && #specimen.specimenClass== 'Tissue'",
              "format": "%SYS_UID%"
            },
            {
              "criteria": "#specimen.lineage == 'Derived' && #specimen.specimenClass != 'Tissue'",
                "format": "%PR_SPEC_LABEL%_%SP_TYPE%%VISIT_SP_TYPE_UID(1,output_one)%"
            }

          ]
        }
      }
    },
{
  "name" : "participant-list-view",
  "view" : null,
  "ctrl" : null,
  "data" : {
    "columns" : [ {
      "expr" : "Participant.ppid",
      "caption" : "Registry ID",
      "metainfo" : {
        "showLink" : "true"
      }
    }, {
      "expr" : "concat_ws(\", \", Participant.lastName, Participant.firstName)",
      "caption" : "Name"
    }, {
      "expr" : "Participant.empi",
      "caption" : "MRN"
    }, {
      "expr" : "date_format(Participant.dateOfBirth, \"%month2%/%month_day%/%year4%\")",
      "caption" : "DOB"
    } ],
    "criteria" : "Participant.id exists",
    "orderBy" : [ {
      "expr" : "Participant.regDate",
      "direction" : "desc"
    } ],
    "filters" : [ {
      "expr" : "Participant.ppid",
      "caption" : "Registry ID",
      "searchType" : "contains"
    }, {
      "expr" : "concat_ws(\" \", Participant.lastName, Participant.firstName)",
      "caption" : "Name",
      "metainfo" : {
        "phi" : "true"
      }
    }, {
      "expr" : "Participant.medicalRecord.medicalRecordNumber",
      "caption" : "MRN"
    } ]
  }
}, {
  "name" : "specimen-list-view",
  "view" : null,
  "ctrl" : null,
  "data" : {
    "columns" : [ {
      "expr" : "Specimen.label",
      "caption" : "IBC Code",
      "metainfo" : {
        "showLink" : "true"
      }
    }, {
      "expr" : "Specimen.createdOn",
      "caption" : "Created On"
    }, {
      "expr" : "Specimen.type",
      "caption" : "Specimen Type"
    }, {
      "expr" : "Specimen.tissueSite",
      "caption" : "Anatomic Site"
    },
    {
      "expr" :"Specimen.customFields.wCMCSpecimenFields.pathologicalDx",
      "caption" : "Pathological Dx"
    }, {
      "expr" : "Specimen.availableQty",
      "caption" : "Quantity",
      "metainfo" : {
        "showUnit" : "true",
        "measure" : "quantity"
      }
    }, {
      "expr" : "concat(Specimen.specimenPosition.containerName, concat_ws(\"\", concat(\" (\", Specimen.specimenPosition.formattedPos, \")\")))",
      "caption" : "Location"
    } ],
    "criteria" : "Specimen.availableQty > 0 and Specimen.collectionStatus = \"Collected\"",
    "orderBy" : [ {
      "expr" : "Specimen.createdOn",
      "direction" : "desc"
    } ],
    "filters" : [ {
      "expr" : "Specimen.label",
      "caption" : "Label",
      "searchType" : "contains"
    }, {
      "expr" : "Specimen.lineage",
      "caption" : "Lineage"
    }, {
      "expr" : "Specimen.createdOn",
      "caption" : "Created On"
    }, {
      "expr" : "Specimen.type",
      "caption" : "Specimen Type"
    }, {
      "expr" : "Specimen.tissueSite",
      "caption" : "Anatomic Site"
    }, {
      "expr" :"Specimen.customFields.wCMCSpecimenFields.pathologicalDx",
      "caption" : "Pathological Dx"
    }, {
      "expr" : "Specimen.availableQty",
      "caption" : "Quantity"
    } ]
  }
} ]
